import styled from "styled-components";
import { useNavigate } from "react-router-dom";
import deleteIcon from "../../images/delete.svg";
import piston from "../../images/piston.svg";
import { Link } from "react-router-dom";
import Database from "../../database/database";

const BankInlineDiv = styled.div`
	width: 100%;
	background-color: white;
	border: 1px solid #8794b0;
	border: 1px solid ${(props) => (props.active ? "#0069ff" : "#8794B0")};
	background-color: ${(props) => (props.active ? "#0069ff" : "white")};
	border-radius: 15px;
	padding: 15px;
	display: flex;
	cursor: pointer;
	justify-content: space-between;
	align-items: center;
	transition: 0.5s;

	&:hover {
		background-color: #0069ff;
		border: 1px solid #0069ff;
		> h1 {
			color: white;
		}
		p {
			color: white;
		}
		svg {
			fill: white !important;
		}
	}

	> h1 {
		font-weight: 500;
		font-size: 20px;
		color: ${(props) => (props.active ? "white" : "#080B2D")};
		transition: 0.5s;
	}
`;

const Right = styled.div`
	display: flex;
	gap: 8px;
	svg {
		height: 25px;
		width: 25px;
		cursor: pointer;
		fill: ${(props) => (props.active ? "white" : "#031b4e")};
		transition: 0.5s;
		&:nth-child(2) {
			fill: ${(props) => (props.active ? "white" : "red")};
			z-index: 10;
		}
	}
	> div {
		position: relative;
		> p {
			position: absolute;
			transition: 0.5s;
			bottom: 0;
			right: 0;
			font-weight: 500;
			font-size: 13px;
			cursor: pointer;
			color: ${(props) => (props.active ? "white" : "#031b4e")};
		}
	}
`;

const BankInline = ({ id, engineID, banks, setBanks, database }) => {
	const navigate = useNavigate();

	const handleDelete = async (e) => {
		e.preventDefault();
		const confirmation = window.confirm(
			`Are you sure you want to delete Bank '${id}'`
		);
		if (!confirmation) return;
		await Database.Banks.remove({
			db: database,
			id,
		});
		setBanks(banks.filter((databaseBank) => databaseBank.id !== id));
		navigate(`/engines/${engineID}/edit/banks`);
	};

	const getCylinderCount = async () => {
		
		const stuff = async () => {
			const cylinders = await Database.Engines.Cylinders.all({
				db: database,
				id,
			});
	
			let i = 0;
			cylinders.forEach(element => {
				if(element.bank === id) {
					i++;
				}
			});

			return i;
		};
		const something = await stuff();

		return toString(something);
	};
	//const stuff = getCylinderCount();

	return (
		<Link to={`/engines/edit/banks/${id}`}>
			<BankInlineDiv
				active={
					window.location.pathname === `/engines/edit/banks/${id}`
				}
			>
				<h1>Bank {id}</h1>
				<Right
					active={
						window.location.pathname === `/engines/edit/banks/${id}`
					}
				>
					<div>
						<svg
							viewBox="0 0 25 25"
							xmlns="http://www.w3.org/2000/svg"
						>
							<path d="M17.7452 0.2512C17.601 0.2752 17.351 0.3522 17.1922 0.4242C16.923 0.5397 16.6442 0.803949 13.8317 3.6067C12.1442 5.28945 10.7067 6.7557 10.6395 6.87095C10.3702 7.3277 10.2645 7.9862 10.3895 8.5102C10.5 8.99095 10.6682 9.2362 11.3655 9.9477L12.0385 10.6352L8.91849 13.7602C7.19749 15.4815 5.69274 16.9717 5.56774 17.0775L5.34174 17.2697L5.03874 17.1832C4.57249 17.0535 3.60124 17.068 3.10624 17.2072C2.38499 17.414 1.82749 17.7505 1.32274 18.2842C0.966992 18.6545 0.870742 18.789 0.654492 19.217C-0.436758 21.3947 0.774742 24.0485 3.14949 24.6735C3.68324 24.813 4.53874 24.813 5.07249 24.6735C6.16849 24.385 7.08199 23.635 7.57249 22.6255C7.86574 22.0245 7.95224 21.6495 7.95224 20.9187C7.95224 20.26 7.85599 19.7985 7.61574 19.3225L7.49074 19.0772L10.7407 15.8272L13.9857 12.5822L14.8175 13.3997C15.6925 14.2649 15.8942 14.4092 16.428 14.5487C16.952 14.6832 17.4665 14.6207 17.9807 14.3515C18.2547 14.2072 18.6777 13.8082 21.3507 11.1209C24.7065 7.76045 24.5957 7.8902 24.7207 7.17395C24.7977 6.73645 24.7207 6.26545 24.5045 5.82795C24.37 5.5492 24.0957 5.2607 21.9085 3.0877C20.4807 1.6647 19.3702 0.6022 19.2402 0.520451C18.8172 0.2752 18.226 0.1647 17.7452 0.2512ZM18.6635 1.2222C18.8317 1.2992 19.5 1.9337 21.2595 3.6837C23.8845 6.28945 23.8602 6.26045 23.8602 6.8277C23.8602 7.2267 23.7352 7.5007 23.4227 7.8037L23.1967 8.02495L20.0527 4.90495L16.9037 1.78495L17.12 1.5637C17.5482 1.11645 18.1635 0.981951 18.6635 1.2222ZM19.8797 5.97695L22.572 8.65945L22.0912 9.1402L21.6105 9.62095L18.476 6.48645L15.3367 3.3472L15.803 2.88095L16.2692 2.40995L16.7307 2.85695C16.9857 3.0972 18.399 4.50595 19.8797 5.97695ZM17.8605 7.1212L20.9855 10.2462L19.351 11.8807C17.5482 13.6835 17.5 13.7217 16.9425 13.7267C16.3847 13.7267 16.3847 13.7267 13.7407 11.0777C11.4475 8.77495 11.3515 8.67395 11.2792 8.42395C11.183 8.0922 11.183 7.9287 11.2792 7.59695C11.3512 7.3517 11.438 7.2557 13.0195 5.66445C13.9377 4.7462 14.6972 3.9962 14.7117 3.9962C14.726 3.9962 16.1442 5.39995 17.8605 7.1212ZM10.1735 15.1447L6.98124 18.337L6.65424 18.0437C6.47649 17.8802 6.31299 17.7457 6.29374 17.7457C6.26974 17.7457 6.25049 17.7265 6.25049 17.7025C6.25049 17.6737 7.69274 16.217 9.46199 14.4575L12.6685 11.2605L13.0195 11.6067L13.3657 11.953L10.1735 15.1447ZM5.07274 18.1255C5.55824 18.289 5.92374 18.5292 6.29874 18.9282C6.81324 19.481 7.08224 20.1687 7.08224 20.9425C7.08224 21.9617 6.60624 22.8367 5.75549 23.4087C5.22674 23.7597 4.81799 23.8752 4.11124 23.8752C3.40449 23.8752 2.99599 23.7597 2.46699 23.4087C1.20249 22.558 0.774742 20.9572 1.45249 19.587C1.63024 19.2217 2.11099 18.688 2.47174 18.4477C3.23124 17.9427 4.19774 17.8227 5.07274 18.1255Z" />
							<path d="M15.553 8.40945C15.2502 8.54895 15.0002 8.9142 15.0002 9.2122C15.0002 9.52945 15.279 9.9092 15.6012 10.0342C16.332 10.313 17.0147 9.5487 16.6877 8.81795C16.5 8.41445 15.9617 8.21721 15.553 8.40945Z" />
						</svg>
						<p>4</p>
					</div>
					<svg
						onClick={handleDelete}
						viewBox="0 0 30 30"
						xmlns="http://www.w3.org/2000/svg"
					>
						<path d="M23.703 3.59425H19.0332C18.8003 1.57428 17.0817 0 15.0002 0C12.9188 0 11.2004 1.57422 10.9675 3.59425H6.29747C4.40765 3.59425 2.87036 5.13196 2.87036 7.02171V7.19759C2.87036 8.64171 3.76957 9.87777 5.03629 10.3814V26.5725C5.03629 28.4624 6.57376 30 8.46346 30H21.537C23.4269 30 24.9642 28.4622 24.9642 26.5725V10.3815C26.2308 9.87777 27.1301 8.64171 27.1301 7.19765V7.02178C27.1301 5.13197 25.5927 3.59425 23.703 3.59425ZM15.0002 1.62546C16.184 1.62546 17.1722 2.47398 17.3909 3.59425H12.61C12.8286 2.47392 13.8168 1.62546 15.0002 1.62546ZM23.3387 26.5725C23.3387 27.5661 22.5303 28.3746 21.537 28.3746H8.46338C7.4701 28.3746 6.66169 27.5661 6.66169 26.5725V10.625H23.3387V26.5725ZM25.5047 7.19759C25.5047 8.19117 24.6962 8.99964 23.7029 8.99964H6.29747C5.30419 8.99964 4.49578 8.19117 4.49578 7.19759V7.02171C4.49578 6.02812 5.30419 5.21966 6.29747 5.21966H23.703C24.6963 5.21966 25.5047 6.02812 25.5047 7.02171V7.19759Z" />
						<path d="M10.6425 26.2959C11.0914 26.2959 11.4552 25.9318 11.4552 25.4832V16.3324C11.4552 15.8836 11.0913 15.5196 10.6425 15.5196C10.1937 15.5196 9.82983 15.8836 9.82983 16.3324V25.4832C9.82977 25.932 10.1937 26.2959 10.6425 26.2959Z" />
						<path d="M15.0004 26.2959C15.4492 26.2959 15.8131 25.9318 15.8131 25.4832V16.3324C15.8131 15.8836 15.4492 15.5196 15.0004 15.5196C14.5516 15.5196 14.1877 15.8836 14.1877 16.3324V25.4832C14.1877 25.932 14.5516 26.2959 15.0004 26.2959Z" />
						<path d="M19.3577 26.2959C19.8065 26.2959 20.1704 25.9318 20.1704 25.4832V16.3324C20.1704 15.8836 19.8065 15.5196 19.3577 15.5196C18.9087 15.5196 18.545 15.8836 18.545 16.3324V25.4832C18.5448 25.932 18.9089 26.2959 19.3577 26.2959Z" />
					</svg>
				</Right>
			</BankInlineDiv>
		</Link>
	);
};

export { Right, BankInlineDiv };
export default BankInline;
